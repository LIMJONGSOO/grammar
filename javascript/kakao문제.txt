문제 보기
카카오 지도에 아래 이미지와 같이 공공 마스크를 구매할 수 있는 약국의 위치와 수량을 표시하려고 합니다.

kakaoFE.png

카카오 지도 API와 아래에 제공하는 약국 정보 API 및 마스크 수량 API를 활용하여 다음 기능을 구현해 주세요.

수행 기술
Vanilla JavaScript를 활용해서 문제를 풀어 주세요.
설치되어있는 모듈(node_modules) 외에 다른 외부 라이브러리는 사용하지 않도록 합니다. 예를 들어 jQuery, Webpack, Lodash, Axios, Angular, React, Vue, Immutable-js, Ramda 등을 사용할 수 없습니다.
클라이언트 API
이 테스트에서는 카카오 맵에서 제공하는 JavaScript API 중, 아래에 명시된 API를 사용할 수 있습니다.
(BundangguMap.js에서 주어진 API이외에 다른 카카오맵 API이용은 금지되니 참고해 주세요.)

1. 지도에 마커/인포윈도우 그리기
마커 이미지를 만들기 위한 new kakao.maps.MarkerImage
마커를 만들기 위한 new kakao.maps.Marker
인포윈도우를 만들기 위한 new kakao.maps.InfoWindow
2. 지도 객체에서 사용 가능한 메소드
setCenter: 지도 중심 위치 설정
getBounds: 지도가 그리고 있는 영역 획득
bounds 객체에서 좌표를 획득하기 위한 getSouthWest, getNorthEast, getLat, getLng까지 이용 가능
getLevel: 지도의 줌 레벨 획득
3. 이용 가능 이벤트
지도 위치 변경: 카카오맵에서 지도 위치 변경을 인식할 수 있는 방법은 여러가지가 있지만, 이 과제를 수행하면서는 반드시 drag이벤트를 통해 지도 위치 변경을 처리해 주세요.(dragend, dragstart 이벤트는 코드에서 사용해서는 안됩니다)
지도 줌 레벨 변경
서버 API
1. 약국 정보 API
URL
GET /storesByGeo
HOST: https://v5ovcy0d38.execute-api.ap-northeast-2.amazonaws.com/dev/
Parameter
sw: (필수) 정보를 요청하는 영역의 남서쪽 끝 모서리 위치
콤마(,)로 구분하며 숫자가 아닐 경우 400 에러를 리턴한다.
ne: (필수) 정보를 요청하는 영역의 북동쪽 끝 모서리 위치
콤마(,)로 구분하며 숫자가 아닐 경우 400 에러를 리턴한다.
errorRate: (옵션) 불안정한 서버/네트워크 환경을 가정해 서버 에러 발생률(0~100, 100이면 100% 확률로 에러 발생)
숫자가 아니거나, 0-100 사이가 아닐 경우 400 에러를 리턴한다.
에러 발생 시 500 에러(Internal Servr Error)를 리턴한다.
delay: (옵션) 불안정한 서버/네트워크 환경을 가정해 API요청에 적용할 delay(0~5, 초단위)
숫자가 아니거나, 0-5 사이가 넘어갈 경우 400 에러를 리턴한다.
Response
다음과 같은 약국 정보로 구성된 배열

code: 약국 code
name: 약국명
addr: 주소
lat: 위도
lng: 경도
예시

지도 좌하단의 위경도가 37.395356858155154,127.0900521371181이고, 우상단의 위경도가 37.411828533560616,127.12802536370398이면 아래와 같이 요청합니다.

curl 'https://v5ovcy0d38.execute-api.ap-northeast-2.amazonaws.com/dev/storesByGeo?sw=37.395356858155154,127.0900521371181&ne=37.411828533560616,127.12802536370398'

[
  {"addr":"경기도 성남시 분당구 동원동 40-1 670","code":"31839002","lat":37.4020288,"lng":127.1066516,"name":"광장약국"},
  {"addr":"경기도 성남시 분당구 야탑동 355-6 24-8 102호","code":"31844448","lat":37.4116424,"lng":127.1276327,"name":"한솔약국"}
]
※ 분당구 이외의 정보는 제공하지 않습니다. 기본 코드에서 주어진 지도 시작 위치에서 멀리 이동할 경우 정보가 제공되지 않을 수 있습니다.

2. 마스크 수량 API
URL
GET /sales
HOST: https://v5ovcy0d38.execute-api.ap-northeast-2.amazonaws.com/dev/
Parameter
code: (필수) 약국 코드. 최대 4개까지 콤마(,)로 구분된 약국 코드를 전달할 수 있음
4개가 넘어갈 경우 400 에러를 리턴한다.
errorRate: (옵션) 불안정한 서버/네트워크 환경을 가정해 서버 에러 발생률(0~100, 100이면 100% 확률로 에러 발생)
에러 발생 시 500 에러(Internal Servr Error)를 리턴한다.
숫자가 아니거나, 0-100 사이가 아닐 경우 400 에러를 리턴한다.
delay: (옵션) 불안정한 서버/네트워크 환경을 가정해 API요청에 적용할 delay(0~5, 초단위)
숫자가 아니거나, 0-5 사이가 넘어갈 경우 400 에러를 리턴한다.
Response
다음과 같은 마스크 수량 정보로 구성된 배열

code: 약국 code
remain_stat: 잔여 마스크 수량
kf94_large: kf94 대형 마스크 보유 수량
kf80_large: kf80 대형 마스크 보유 수량
kf94_medium: kf94 중형 마스크 보유 수량
kf80_medium: kf80 중형 마스크 보유 수량
kf94_small: kf94 소형 마스크 보유 수량
kf80_small: kf80 소형 마스크 보유 수량
예시

curl 'https://v5ovcy0d38.execute-api.ap-northeast-2.amazonaws.com/dev/sales?code=31802095,31811931'

[
  {"code":"31802095","remain_stat":8,"kf94_large":6,"kf80_large":0,"kf94_medium":1,"kf80_medium":0,"kf94_small":0,"kf80_small":1},  
  {"code":"31811931","remain_stat":29,"kf94_large":28,"kf80_large":0,"kf94_medium":0,"kf80_medium":0,"kf94_small":0,"kf80_small":1}
]
구현 요구사항
※ 말머리에 [필수]가 붙은 요구사항은 반드시 수행해야 하는 것, [옵션]은 필수는 아니지만 구현하면 가산점이 있는 것입니다. 필수 항목을 다 구현한 다음, 옵션 항목을 구현해 주세요.

요구사항 1. 자바스크립트 버전 명시
주어진 코드에서 main.js의 최상단에 이번 과제를 수행하면서 작성한 자바스크립트의 버전을 적어주세요
아래와 같이 적으면 됩니다.

// 여기에 코드 작성 중에 사용한 자바스크립트 버전을 주석으로 명시해 주세요. 
// ES1로 작성하였음

import App from "./components/App.js";
new App();
요구사항 2. 약국 그리기
[필수] 요구사항 2.1
처음 페이지가 로드되면 판교역(37.3947° N, 127.1112° E)을 중심으로 하는 지도에 약국의 위치를 표시하고, 잔여 마스크 수량(마스크 사이즈별이 아닌, 전체 보유 수량)에 따라 다른 마커 이미지를 이용해 표시해 주세요.

마스크 수량 많음(50개 이상) 이미지: https://grepp\-cloudfront\.s3\.ap\-northeast\-2\.amazonaws\.com/programmers\_imgs/competition\-imgs/2020\_kakao\_challenge/marker\-4\-green\.png
마스크 수량 보통(10개 이상 50개 미만) 이미지: https://grepp\-cloudfront\.s3\.ap\-northeast\-2\.amazonaws\.com/programmers\_imgs/competition\-imgs/2020\_kakao\_challenge/marker\-4\-yellow\.png
마스크 수량 적음(1개 이상 10개 미만) 이미지: https://grepp\-cloudfront\.s3\.ap\-northeast\-2\.amazonaws\.com/programmers\_imgs/competition\-imgs/2020\_kakao\_challenge/marker\-4\-red\.png
마스크 수량 없음(0개) 이미지: https://grepp\-cloudfront\.s3\.ap\-northeast\-2\.amazonaws\.com/programmers\_imgs/competition\-imgs/2020\_kakao\_challenge/marker\-4\-grey\.png
다음과 같이 이미지를 적용한 마커를 생성할 수 있습니다.

var imageSrc = "https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/markerStar.png";
var imageSize = new kakao.maps.Size(24, 35); 
var markerImage = new kakao.maps.MarkerImage(imageSrc, imageSize); 

// 마커를 생성합니다
var marker = new kakao.maps.Marker({
    map: map, // 마커를 표시할 지도
    position: positions[i].latlng, // 마커를 표시할 위치
    title : positions[i].title, // 마커의 타이틀, 마커에 마우스를 올리면 타이틀이 표시됩니다
    image : markerImage // 마커 이미지 
});
마스크 수량은 변할 수 있으므로 값을 캐싱하지 마세요.
약국정보는 변하지 않으므로 캐싱하는 것을 권장합니다.
[필수] 요구사항 2.2
지도를 이동하거나 줌 레벨이 변경되는 것에 따라 지도에 마커를 표시해 주세요. 지도의 이동은 drag이벤트를 이용해야 하며, 마우스 드래그 중(클릭한 마우스에서 손가락을 때기전)에도 마커는 업데이트되어야 합니다.

drag이벤트는 마우스를 조금만 움직여도 지속적으로 발생하는 이벤트입니다. 이 때 너무 많은 API 호출이 발생하지 않도록 디바운스를 적절히 구현하세요.
[필수] 요구사항 2.3
지도의 약국 마커를 클릭하면 약국 상세 정보를 PharmacyInfo를 이용해서 표시해 주세요.
상세 정보는 ESC를 누르거나, 검은 배경을 마우스로 클릭하면 사라져야 합니다.

약국 상세 정보는 약국 이림 및 주소, KF94/80과 대/중/소 사이즈별 보유 마스크 수량을 아래와 같이 텍스트로 표시하면 됩니다.

예시

희망약국(120개 보유)
경기도 성남시 분당구 서현로 184 219호 (서현동, 엘지에클라트)
KF94 대형: 20개
KF94 중형: 20개
KF94 소형: 20개
KF80 대형: 20개
KF80 중형: 20개
KF80 소형: 20개
[필수] 요구사항 2.4
API 서버 또는 네트워크가 매우 불안정한 것을 가정해서 약국 그리기 기능을 구현해 주세요. 이와 같은 환경을 테스트하기 위해 제공하는 서버 API의 delay 및 error parameter를 이용해 구현한 기능의 테스트가 가능합니다.

[옵션] 요구사항 2.5
지도 확대 레벨이 7 이상이 되면 동별로 현재 판매 중인 약국의 숫자를 인포윈도우로 표시해 주세요. 약국의 숫자를 표시할 때는 '판교동: 5개 약국'과 같이 동 이름과 약국 숫자를 함께 표시합니다.

동 정보는 약국의 주소(addr)을 이용해 주세요.
인포윈도우의 removable 옵션을 false로 설정해 인포윈도우를 닫을 수 없도록 해야 합니다.
이때 기존에 표시된 약국 마커는 화면에 보이지 않아야 합니다.
인포윈도우의 위치는 해당 동에 속한 약국의 위도 평균/경도 평균에 그려주시면 됩니다.
지도상에서 표시되는 약국의 평균 위치가 아닌, 해당 동에 속한 모든 약국의 평균 위경도에 그려주세요. 예를 들어 현재 지도에 판교동의 일부만이 표시되고 있더라도 지도상에 표시되는 판교동 약국의 평균 위치가 아닌, 판교동에 속한 모든 약국의 평균 위치에 인포윈도우를 그려주면 됩니다.
카카오 맵에서 기본으로 제공하는 마커 클러스터 기능을 이용해서는 안되며, 인포윈도우를 이용해서 직접 구현해야 합니다.
지도의 확대 레벨이 7 미만이 되면 다시 인포윈도우를 화면에서 지우고, 약국 마커를 표시해야 합니다.
이 기능을 테스트할 때는 줌 레벨 6에서 분당구의 모든 지역을 스캔한 다음에 좀 레벨 7로 이동할 예정입니다. 따라서 모든 약국의 위치가 지도에 한 번은 그려진 다음에 레벨 7로 이동하게 됩니다.

[옵션] 요구사항 2.6
약국 정보 API를 호출했을 때, 로딩 중일 때 지도를 이동하면 지도 밖으로 벗어난 약국의 수량 조회 API에 대한 AJAX 요청을 취소하는 기능을 구현해 주세요.

[옵션] 요구사항 2.7
데이터 로딩 중에는 로딩 중임을 알리는 gif(프로젝트 최상위 폴더의 loading.gif)를 화면 우상단 <div id="loading">영역에 표시해 주세요.

[필수] 요구사항 3. 최근 조회한 약국 목록 표시하기
약국을 선택해서 상세 정보를 조회한 약국 약국 목록을 최근 클릭한 순서대로 <div class="recently-viewed-pharmacy">에 표시하세요.

최근 조회한 순서대로 유니크한 5개 약국의 이름만 선택해야 합니다.
화면을 새로고침해도 최근 조회한 약국 목록은 유지되어야 합니다.
같은 약국을 두 번 클릭했을 때 같은 이름이 두 번 나와서는 안됩니다.
예시

예를 들어 약국A - 약국C - 약국B - 약국D - 약국B - 약국E - 약국F 순으로 상세 정보를 조회했다면
<div class="recently-viewed-pharmacy">에는 약국F - 약국E - 약국B - 약국D - 약국 C 순으로 표시해야합니다.

[필수] 요구사항 4. 약국 정보 클릭 시 해당 약국 중심으로 이동
왼쪽 리스트에 표시되는 약국 목록 또는 최근 조회한 약국 목록에서 약국을 클릭하면 해당 약국의 위치를 지도의 가운데 위치하도록 만드세요.